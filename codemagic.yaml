workflows:
  android-workflow:
    name: Build Android APK
    environment:
      groups:
        - keystore
      vars:
        FLET_VERSION: "0.28.3"
        FLUTTER_VERSION: "3.22.0"
    scripts:
      - name: Setup Flutter
        script: |
          flutter channel stable
          flutter upgrade
          flutter --version
      - name: Install dependencies
        script: |
          sudo apt-get update
          sudo apt-get install -y python3-pip openjdk-17-jdk
          python3 -m pip install --upgrade pip
          python3 -m pip install flet==$FLET_VERSION
          python3 -m pip install docxtpl pandas

      - name: Build APK
        script: |
          flet clean
          flet pack main.py --name MiAppFlet
          flet build apk --build-version 1.0.0 
    artifacts:
      - build/app/outputs/flutter-apk/*.apk
      - build/apk/*.apk
    publishing:
      scripts:
        - name: Listar archivos generados
          script: ls -R build/
